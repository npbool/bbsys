{% load rank_tags %}

<div class="table-container">
  <table class="table table-striped table-bordered table-condensed rank-table">
    <thead>
    <tr>
      <th rowspan="3" class="student-id" data-key="student_id">学号</th>
      <th rowspan="3" class="name">姓名</th>
      <th rowspan="3" class="class">班级</th>
      <th rowspan="3" class="school">学校</th>
      <th rowspan="3" class="prop">类型</th>
      {% for subject in subjects %}
        <th colspan="5" class="subject" data-key="{{ subject }}">{{ subject }}</th>
      {% endfor %}
    </tr>
    <tr>
      {% for subject in subjects %}
        <th colspan="2">{{ exam_cmp.name }}</th>
        <th colspan="2">{{ exam.name }}</th>
        <th rowspan="2">排名升降</th>
      {% endfor %}
    </tr>
    <tr>
      {% for subject in subjects %}
        <th class="score" data-key="{{ subject }}">成绩</th>
        <th class="rank" data-key="{{ subject }}">校排</th>
        <th class="score" data-key="{{ subject }}">成绩</th>
        <th class="rank" data-key="{{ subject }}">校排</th>
      {% endfor %}
    </tr>
    </thead>
    <tbody>
    {% for row in data %}
      <tr>
        <td>{{ row.student_id }}</td>
        <td>{{ row.name }}</td>
        <td>{{ row.class_idx }}</td>
        <td>{{ row.school }}</td>
        <td>{{ row.prop }}</td>
        {% for subject in subjects %}
          <td>{{ row|score_cmp:subject }}</td>
          <td>{{ row|rank_school_cmp:subject }}</td>
          <td>{{ row|score:subject }}</td>
          <td>{{ row|rank_school:subject }}</td>
          <td {% if row|rank_diff:subject >= 0 %} class="rank-up" {% else %} class="rank-down" {% endif %}>
            {{ row|rank_diff:subject }}
          </td>
        {% endfor %}
      </tr>
    {% endfor %}
    </tbody>
  </table>
</div>
